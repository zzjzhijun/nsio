# nsio

通过TCP/UDP网络存储数据，支持EC、REPL两种冗余模式。

#系统模块(计划)
##块存储层
1、每个服务器支持多块磁盘(1-64),每块磁盘具有统一的编码diskid(16bit)
2、磁盘分割为64kB-4MB 数据块,每个数据块使用32bit编码(全局编码为diskid|blockid)
3、使用CRC32校验有效性,CRC存储在每块盘开始的区域，每32bit记录一个数据块的CRC
4、API，支持整块数据的写入、读取和校验

##冗余层(逻辑盘或者桶)
支持EC和REP，二选一
1、服务器级别的冗余，可定义集群中最多几台服务器发生故障时存储可用,适用于8台服务器以上的集群
2、硬盘级别的冗余，1-3台服务器的情况，只考虑磁盘级别的冗余
3、冗余层是一批磁盘的组合，按照每块磁盘提供100MB/s的写来确定最少磁盘数量
4、桶的磁盘数量是固定的，考虑到磁盘争用，可能会调整物理磁盘的位置
5、桶每次扩展的数据块称为桶分区
###EC桶
1、根据容量和性能要求，桶内硬盘数量为:N+M，每N个数据块使用M个EC块冗余,对于EC:6:3：数据分布为:D1:D2:D3:D4:D5:D6:E1:E2:E3
2、EC块随机分布到每块磁盘,对于某个桶分区，这个分布是固定的
###REP桶
1、根据容量和性能要求，桶内硬盘数量为:N*M，对于M=3，可能的数据分布为：D1:D2:D3:D1:D2:D3:D1:D2:D3
2、数据固定分布到磁盘

##对象存储层
1、对象目录存储在高可用的核心(zookeeper等)
2....未完待续

